<html>
  <head>
    <title>Painterro demo</title>
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <style>
      html,body,#wrapper {
        height:100%;
        margin:0;
        padding:0;
        background-color: white;
      }

      #conatiner {
        position: absolute;
        top: 50px;
        bottom: 50px;
        left: 20px;
        right: 20px;
      }

    </style>
  </head>
<body>

<div id="wrapper">
  <input type='text'/>
  <div id="conatiner">

  </div>
  <button onclick="p.show()">Show</button>
  <button onclick="saveTest()">Save</button>
</div>

<!--<script src="https://github.com/ivictbor/painterro/releases/download/0.1.7/painterro-0.1.7.min.js"></script>-->
<script src="/painterro.min.js"></script>

<script>

//  Painterro({
//    id: 'conatiner',
//    backgroundFillColor: '#eee',
//    colorScheme: {
//      main: '#faf',
//      control: '#d5d',
//      activeControl: '#572257',
//      inputBackground: '#cf99ca',
//    }
//  });

  function saveTest() {
    const u = window.p.imageSaver.asDataURL('image/png');
    console.log('saved', u.length, u);
  }  

  window.p = Painterro({
    hideByEsc: true,
    saveByEnter: true,
    //toolbarHeightPx: 50,
    //buttonSizePx: 42,
    // defaultTool: 'arrow',
    onChange: (e) => {console.log('onchange e', e)},
    onUndo: (e) => {console.log('onUndo e', e)},
    onRedo: (e) => {console.log('onRedo e', e)},
    //id: 'conatiner',
    initText: 'Press <b>PrtScr</b>, <b>Ctrl+V</b> to paste screenshot.<br>Press <b>Ctrl+S</b> to save', // todo: different for os-es

    //extraFonts: ['Open Sans'],
    onBeforeClose: function (has, done) {
      console.log('has unsaved: ', has);
      window.confirmClose = done;
    },
    // language: 'ja',
    //availableLineWidths: [1,2,4,8,16,64],
    //availableEraserWidths: [1,2,4,8,16,64],
    //availableFontSizes: [1,2,4,8,16,64],
    //availableArrowLengths: [10,20,30,40,50,60],
    // how_to_paste_actions: ['replace_all'],
    saveHandler: (saver) => {
      console.log('saving', saver.getWidth(), saver.getHeight())
    }
    //toolbarPosition: 'top',
    // fixMobilePageReloader: false,
    // defaultTool: 'line',
    //hiddenTools: ['line']
  }).show('https://images.unsplash.com/photo-1565118531796-763e5082d113?ixlib=rb-1.2.1&ixid=eyJhcHBfaWQiOjEyMDd9&auto=format&fit=crop&w=1350&q=80') //;
  const ctx = window.p.ctx; 

console.log(ctx);
  ctx.beginPath();
  ctx.moveTo(0,0);
  ctx.lineTo(300,150);
  ctx.strokeStyle="#FF0000";
  ctx.stroke(); 


  /*
    
document.onpaste = (event) => {
  const { items } = event.clipboardData || event.originalEvent.clipboardData;
  Array.from(items).forEach((item) => {
    if (item.kind === 'file') {
      if (!window.painterroOpenedInstance) {
        // if painterro already opened - it will handle onpaste
        const blob = item.getAsFile();
        const reader = new FileReader();
        reader.onload = (readerEvent) => {
            window.painterroOpenedInstance = Painterro({
              initText: 'Press <b>PrtScr</b>, <b>Ctrl+V</b> to paste screenshot.<br>Press <b>Ctrl+S</b> to save', // todo: different for os-es
              onHide: () => {
                window.painterroOpenedInstance = undefined;
              },
              saveHandler: (image, done) => {
                console.log('Save it here', image.asDataURL());  // you could provide your save handler
                done(true);
              },
            }).show(readerEvent.target.result, item.type);
        };
        reader.readAsDataURL(blob);
      }
    }
  });
};

*/
  

</script>
</body>
</html>
